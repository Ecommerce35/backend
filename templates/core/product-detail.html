{% extends 'partials/detailbase.html' %}
{% block title %}{{p.title|title}}{% endblock title %}
{% comment %} {% load social_share %} {% endcomment %}
{% load static humanize %}
{% block content %}

<style>
.checked, .half{
    color: orange;
  }
</style>

    <!--End header-->
<main class="main bg-light">
    <div class="page-header breadcrumb-wrap">
        <div class="container">
            <div class="breadcrumb">
                <a href="{% url 'core:index' %}" rel="nofollow"><i class="fi-rs-home mr-5"></i>Home</a>
                <span></span> <a href="{% url 'core:product-list' %}">Product</a><span></span><a href="#">{{p.sub_category.category.main_category.title}}</a><span></span><a href="#">{{p.sub_category.category.title}}</a><span></span> <a href="#"> {{p.sub_category.title}}</a>
            </div>
        </div>
    </div>
    <div class="container mb-30">
        <div class="row">
            <div class="col-xl-12 col-lg-12 m-auto">
                <div class="row">
                    <div class="col-md-9 col-lg-9">
                        <div class="product-detail accordion-detail">
                            <div class="row mb-50 mt-10 bg-white shadow-sm">
                                <div class="col-md-6 col-sm-12 col-xs-12 mb-md-0 mb-sm-5">
                                    <div class="detail-gallery">
                                        <!-- MAIN SLIDES -->
                                        <div style="border: none;" class="product-image-slider w-100">
                                            {% if variant.image_id > 0 %}
                                                <figure class="border-radius-0">
                                                    <a class="popup-image" href="{{variant.image}}">
                                                        <img src="{{variant.image}}" alt="product image" loading="eager" />
                                                    </a>
                                                </figure>
                                            {% else %}
                                                <figure class="border-radius-0">
                                                    <a class="popup-image" href="{{p.image.url}}">
                                                        <img src="{{p.image.url}}" alt="product image" loading="eager" />
                                                    </a>
                                                </figure>
                                            {% endif %}

                                            {% for p in p_image %}
                                            <figure class="border-radius-0">
                                                <a class="popup-image" href="{{p.images.url}}">
                                                    <img src="{{p.images.url}}" alt="product image" />
                                                </a>
                                            </figure>
                                            {% endfor %}
                                        </div>

                                        <!-- THUMBNAILS -->
                                        <div class="slider-nav-thumbnails">
                                            <div><img src="{{p.image.url}}" alt="product image" /></div>
                                            {% for p in p_image %}
                                            <div><img src="{{p.images.url}}" alt="product image" /></div>
                                            {% endfor %}
                                        </div>
                                        {% comment %} {% post_to_facebook object_or_url %}
                                        {% post_to_linkedin object_or_url %}
                                        {% post_to_twitter "{{p.title}}" object_or_url %} 
                                        {% post_to_whatsapp object_or_url %}
                                        {% post_to_telegram object_or_url %}
                                        {% copy_to_clipboard object_or_url %}
                                        {% add_copy_script %} {% endcomment %}
                                    </div>
                                    <!-- End Gallery -->
                                </div>
                                <!-- start script -->
                                <!-- End script -->
                                <div class="col-md-6 col-sm-12 col-xs-12 product__details-content">
                                    <div class="detail-info pr-10 pl-10">
                                        <div class="d-flex justify-content-between">
                                            <span class="stock-status out-stock">{{p.get_percentage|floatformat:0}}%</span>
                                            <a style="color: #16bcdc;" aria-label="Add To Wishlist"  class="action-btn add-to-wishlist ml-5" data-product-item="{{p.id}}"><i class="fas fa-heart"></i></a>
                                        </div>
                                        <h6>{{p.title|truncatechars:150|title}}</h6>
                                        <div class="product-detail-rating border-bottom py-0 my-0">
                                            <div class="product-rate-cover text-end font-xs my-0 py-0">
                                                <span class="fas fa-star {% if average_rating.rating >= 1 %} checked {% elif average_rating.rating > 0 %} fas fa-star-half-alt half {% endif %}"></span>
                                                <span class="fas fa-star {% if average_rating.rating >= 2 %} checked {% elif average_rating.rating > 1 %} fas fa-star-half-alt half {% endif %}"></span>
                                                <span class="fas fa-star {% if average_rating.rating >= 3 %} checked {% elif average_rating.rating > 2 %} fas fa-star-half-alt half {% endif %}"></span>
                                                <span class="fas fa-star {% if average_rating.rating >= 4 %} checked {% elif average_rating.rating > 3 %} fas fa-star-half-alt half {% endif %}"></span>
                                                <span class="mr-10 fas fa-star {% if average_rating.rating >= 5 %} checked {% elif average_rating.rating > 4 %} fas fa-star-half-alt half {% endif %}"></span>
                                                <span> {% if average_rating.rating %} {{ average_rating.rating|floatformat:1 }} {% else %} 0 {% endif %} out of 5.0 </span>|
                                                <span class="font-small ml-5 text-muted"> <a id="Reviews-tab" data-bs-toggle="tab" href="#Reviews">{{p.reviews.count}} review{{p.reviews.count|pluralize}}</a></span> |
                                            </div>
                                        </div>
                                        {% if request.user.is_authenticated %}
                                        <p class="my-2 font-xs">Order above <strong>GH₵200</strong> gets free delivery | regular delivery from Vendor to <strong>{{town}}</strong> is <strong>GH₵{{fee|floatformat:2}}</strong></p>
                                        {% else %}
                                        <p class="my-2 font-xxs">Login to see Delivery cost</p>
                                        {% endif %}
                                        {% include 'alerts/alert.html' %}
                                        {% if p.variant == 'Size-Color' %}
                                            <form method="post" id="post-form">
                                                {% csrf_token %}
                                                <input type="hidden" name="productid" id="productid" value="{{p.id}}">
                                                <div class="d-flex">
                                                    <span class="font-xs">Size:</span>&nbsp;&nbsp;
                                                    <select name="size" id="size">
                                                        {% for rs in sizes %}
                                                        <option {% if variant.size_id == rs.size_id %} selected {% endif %} value="{{rs.size_id}}">{{rs.size.name}}</option>
                                                        {% endfor %}
                                                    </select>
                                                </div>
                                            </form>
                                            <form action="?q=selectvariant" id="post-color" method="post">
                                                {% csrf_token %}
                                                <div class="appendHere" id="appendHere">
                                                    <input type="hidden" name="size" id="size" value="{{ size_id }}">
                                                    <ul class="py-0 my-0">
                                                        <li><span class="font-xs">Color:</span></li>
                                                        <div class="d-flex">
                                                            {% for rs in colors %}
                                                            <div class="d-flex mx-2">
                                                                <input class="form-check-input py-0 my-0 mx-0" type="radio" {% if variant.id == rs.id %} checked {% endif %} name="variantid" id="variantid" value="{{ rs.id }}" onchange="this.form.submit();">
                                                                <li {% if variant.id == rs.id %} class="active py-0 my-0" {% endif %}>
                                                                    <a class="text-center {% if variant.id == rs.id %} active {% endif %}" style="background-color: {{ rs.color.code }}; color: #d9d9d9; text-shadow: 1px 1px #000000; width: 70px; padding: 0 5px;">
                                                                        {{ rs.color }}
                                                                    </a>
                                                                    <br>
                                                                    {% if rs.image %}
                                                                    <img title="{{rs.color}}" src="{{ rs.image }}" style="height: 50px;">
                                                                    {% else %}
                                                                    <img src="{{ p.image.url }}" title="{{rs.color}}" style="height: 50px;">
                                                                    {% endif %}
                                                                </li>
                                                            </div>
                                                            &nbsp;
                                                            {% endfor %}
                                                        </div>
                                                        &nbsp;&nbsp;
                                                    </ul>
                                                </div>
                                            </form>
                                        {% elif p.variant == 'Size' %}
                                            <p class="font-xxs text-muted"><strong>Note: </strong>Product price may vary due to the selected size</p>
                                            <form action="?q=selectvariant" method="post" id="post-color">
                                                <p id="demo"></p>
                                                {% csrf_token %}
                                                <div id="appenHere">
                                                    <input type="hidden" name="size" id="size" value="{{ size_id }}">
                                                    <ul class="d-flex">
                                                        <li><span class="text-uppercase">Size:</span></li> &nbsp; &nbsp; &nbsp; &nbsp;
                                                        <div class="d-flex">
                                                            <select name="variantid" id="variantid" onchange="this.form.submit();">
                                                                {% for rs in sizes %}
                                                                <option value="{{rs.id}}" {% if variant.id == rs.id %} selected {% endif %}>{{ rs.size }}</option>
                                                                {% endfor %}
                                                            </select>
                                                        </div>
                                                    </ul>
                                                </div>
                                            </form>
                                        {% elif p.variant == 'Color' %}
                                            <p class="font-xxs text-muted"><strong>Note: </strong>Product price may vary due to the selected color</p>
                                            <form action="?q=selectvariant" method="post" id="post-color">
                                                {% csrf_token %}
                                                <div id="appenHere">
                                                    <input type="hidden" name="size" id="size" value="{{ size_id }}">
                                                    <ul>
                                                        <li><span class="text-uppercase">Color:</span></li>
                                                        <div class="d-flex">
                                                            {% for rs in colors %}
                                                            <div class="d-flex mx-2">
                                                                <input class="form-check-input" type="radio" {% if variant.id == rs.id %} checked {% endif %} name="variantid" id="variantid" value="{{ rs.id }}" onchange="this.form.submit();"><br>
                                                                <li {% if variant.id == rs.id %} class="active" {% endif %}>
                                                                    <a style="background-color: {{ rs.color.code }}; color: #d9d9d9; text-shadow: 1px 1px #000000; width: 70px; padding: 4px;">
                                                                        {{ rs.color.name }}
                                                                    </a><br>
                                                                    {% if rs.image %}
                                                                    <img src="{{ rs.image }}" style="height: 50px;">
                                                                    {% else %}
                                                                    <img src="{{ p.image.url }}" style="height: 50px;">
                                                                    {% endif %}
                                                                </li>
                                                            </div>
                                                            {% endfor %}
                                                        </div>
                                                    </ul>
                                                </div>
                                            </form>
                                        {% endif %}

                                        {% if p.variant != 'None' %}
                                            <form action="{% url 'order:addtocart' p.id %}" method="post">
                                                {% csrf_token %}
                                                <input type="hidden" name="variant" id="variantid" value="{{ variant.id }}">
                                                <div id="SelectedProduct">
                                                    <p class="mb-0"><strong class="text-muted">Selected: </strong> Size: {{variant.size}} Color: {{variant.color}}</p>
                                                    <p class="mb-0">
                                                        <strong class="text-muted">
                                                            Availability: 
                                                            {% if variant.quantity > 20 %} <span class="text-success"><strong>In Stock</strong></span> 
                                                            {% elif variant.quantity < 1 %} <span class="text-danger"> Out of Stock</span> 
                                                            {% elif variant.quantity < 20 %}<span class="text-warning">Hurry up! we have only {{variant.quantity}} item{{variant.quantity|pluralize}} In Stock</span>{% endif %} 
                                                        </strong>
                                                    </p>
                                                    <h3 class="product-price">₵{{ variant.price|intcomma }}</h3>
                                                </div>
                                                <div class="cart-option mb-15">
                                                    {% if variant.quantity < 1 %}
                                                    <a class="cart-btn bg-danger text-white">Selected product is out of stock</a>
                                                    {% else %}
                                                    {% if control == 1 %}
                                                    <input type="hidden" name="variantid" id="variantid" value="{{ variant.id }}">
                                                    <div class="input-counter">
                                                        <span class="minus-button shadow-sm"><i class="fal fa-minus"></i></span>
                                                        <input type="text" min="1" max="{{variant.quantity}}" name="quantity" value="{{quantity}}">
                                                        <span class="plus-button shadow-sm"><i class="fal fa-plus"></i></span>
                                                    </div>
                                                    <button id="my-button-1" title="Click to add to cart" type="submit" {% if variant.quantity < 1 %} disabled {% endif %} class="cart-btn shadow-sm ml-10">Add to Cart</button>
                                                    {% else %}
                                                    <input type="hidden" name="variantid" id="variantid" value="{{ variant.id }}">
                                                    <input type="hidden" min="1" max="{{variant.quantity}}" name="quantity" value="1">
                                                    <button id="my-button-1" title="Click to add to cart" type="submit" {% if variant.quantity < 1 %} disabled {% endif %} class="cart-btn shadow w-100">Add to Cart</button>
                                                    {% endif %}
                                                    {% endif %}
                                                </div>
                                            </form> 
                                        {% else %}
                                            <form action="/order/addtocart/{{p.id}}/" method="post">
                                                {% csrf_token %}
                                                <div>
                                                    <p>
                                                        <strong>
                                                            Availability: 
                                                            {% if p.total_quantity > 20 %} <span class="text-success"> <strong>In Stock</strong></span> 
                                                            {% elif p.total_quantity < 1 %} <span class="text-danger"> Out of Stock</span> 
                                                            {% elif p.total_quantity < 20 %}<span class="text-warning">Hurry up! we have only {{p.total_quantity}} item{{p.total_quantity|pluralize}} In Stock</span>
                                                            {% endif %}
                                                        </strong>
                                                    </p>
                                                    <p>
                                                        <strong>Variant:</strong> As in the Picture
                                                    </p>
                                                    <h3 class="product-price">₵{{p.price|intcomma}}</h3>
                                                </div>                                                
                                                <div class="cart-option mb-15">
                                                    {% if p.total_quantity < 1 %}
                                                    <a  class="cart-btn bg-danger text-white">Product is Out of stock</a>
                                                    {% else %}
                                                    {% if control == 1 %}
                                                    <div class="input-counter">
                                                        <span class="minus-button shadow-sm"><i class="fal fa-minus"></i></span>
                                                        <input type="text" min="1" max="{{p.total_quantity}}" name="quantity" value="{{quantity}}">
                                                        <span class="plus-button shadow-sm"><i class="fal fa-plus"></i></span>
                                                    </div>
                                                    <button id="my-button-1" title="Click to add to cart" type="submit" {% if p.total_quantity < 1 %} disabled {% endif %} class="cart-btn shadow ml-10">Add to Cart</button>
                                                    {% else %}
                                                    <input type="hidden" min="1" max="{{p.total_quantity}}" name="quantity" value="1">
                                                    <button id="my-button-1" title="Click to add to cart" type="submit" {% if p.total_quantity < 1 %} disabled {% endif %} class="cart-btn shadow w-100">Add to Cart</button>
                                                    {% endif %}
                                                    {% endif %}
                                                </div>
                                            </form>
                                        {% endif %}    
                                                                                    
                                        {% comment %} <div class="font-xs">
                                            <ul class="mr-50 float-start">
                                                <li style="color: black;" class="mb-5">Type: <span>{{p.type}}</span></li>
                                                <li style="color: black;"  class="mb-5">MFG:<span> {{p.mfd|date:"M Y"}}</span></li>
                                                <li style="color: black;" >LIFE: <span>{{p.life}} Days</span></li>
                                            </ul>
                                            <ul class="float-start">
                                                <li style="color: black;"  class="mb-5">SKU: <a href="#">{{p.sku}}</a></li>
                                                <li style="color: black;"  class="mb-5">Tags: {% for tag in p.tags.all %}<a href="{% url 'core:tags' tag.slug %}" rel="tag"> #{{tag.name}}</a>,{% endfor %}</li>
                                            </ul>
                                        </div> {% endcomment %}
                                    </div>
                                    <!-- Detail Info -->
                                </div>
                            </div>
                            {% if p.video %}
                            <div class="bg-white">
                                <div class="mt-30 shadow-sm pt-10 p-30 mb-20">
                                    <h3 class="">Product Video</h3>
                                    <video src="{{p.video.url}}" class="text-center w-100 popup-video" width="300" controls>
                                        <source src="{{p.video.url}}" type="video/mp4">
                                    </video>
                                </div>
                            </div>
                            {% endif %}
                            <div class="product-info px-2">
                                <div class="tab-style3">
                                    <ul class="nav nav-tabs text-uppercase">
                                        <li class="nav-item">
                                            <a class="nav-link active" id="Description-tab" data-bs-toggle="tab" href="#Description">Description</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" id="Additional-info-tab" data-bs-toggle="tab" href="#Additional-info">Specifications</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" id="Vendor-info-tab" data-bs-toggle="tab" href="#Vendor-info">Vendor</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" id="Reviews-tab" data-bs-toggle="tab" href="#Reviews">Reviews ({{reviews.count}})</a>
                                        </li>
                                    </ul>
                                    <div class="tab-content shop_info_tab entry-main-content">
                                        <div class="tab-pane fade show active" id="Description">
                                            <div class="">
                                                <p>{{p.description|safe}}</p>
                                                
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="Additional-info">
                                            {{p.specifications|safe}}
                                        </div>
                                        <div class="tab-pane fade" id="Vendor-info">
                                            <div class="vendor-logo d-flex mb-30">
                                                <img src="{{ p.vendor.about.profile_image.url }}" alt="" />
                                                <div class="vendor-name ml-15">
                                                    <h6>
                                                        <a href="{{p.vendor.get_absolute_url}}">{{p.vendor.name}}</a>
                                                    </h6>
                                                    <div class="product-rate-cover text-end">
                                                        <div class="product-rate d-inline-block">
                                                            <div class="product-rating" style="width: 90%"></div>
                                                        </div>
                                                        <span class="font-small ml-5 text-muted"> ({{p.reviews.count}} review{{p.reviews.count|pluralize}})</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <ul class="contact-infor mb-50">
                                        <li><img src="{% static 'assets/imgs/theme/icons/icon-location.svg' %}" alt="" /><strong>Address: </strong> <span>{{p.vendor.address}}</span></li>
                                                <li><img src="{% static 'assets/imgs/theme/icons/icon-contact.svg' %}" alt="" /><strong>Contact Seller:</strong><span>{{p.vendor.contact}}</span></li>
                                            </ul>
                                            <div class="d-flex mb-55">
                                                <div class="mr-30">
                                                    <p class="text-brand font-xs">Rating</p>
                                                    <h4 class="mb-0">92%</h4>
                                                </div>
                                                <div class="mr-30">
                                                    <p class="text-brand font-xs">Ship on time</p>
                                                    <h4 class="mb-0">{{p.vendor.about.shipping_on_time}}%</h4>
                                                </div>
                                                <div>
                                                    <p class="text-brand font-xs">Chat response</p>
                                                    <h4 class="mb-0">{{p.vendor.about.chat_resp_time}}%</h4>
                                                </div>
                                            </div>
                                            <p>{{p.vendor.description|safe}}</p>
                                        </div>
                                        <div class="tab-pane fade" id="Reviews">
                                            <!--Comments-->
                                            <div class="comments-area">
                                                <div class="row">
                                                    <div class="col-lg-8">
                                                        <h4 class="mb-30">Customer questions & answers</h4>
                                                        <div class="comment-list">
                                                            {% for r in reviews %}
                                                            <div class="single-comment justify-content-between d-flex mb-30">
                                                                <div class="user justify-content-between d-flex">
                                                                    <div class="thumb text-center">
                                                                        <img src="https://simg.nicepng.com/png/small/73-730154_open-default-profile-picture-png.png" alt="" />
                                                                        <a href="#" class="font-heading text-brand">{{r.user.username | title}}</a>
                                                                    </div>
                                                                    <div class="desc">
                                                                        <div class="d-flex justify-content-between mb-10">
                                                                            <div class="d-flex align-items-center">
                                                                                <span class="font-xs text-muted">{{r.date|date:"d M, Y"}}</span>
                                                                            </div>
                                                                            <div>
                                                                                {% for s in r.rating|ljust:r.rating %}
                                                                                    <i class="fas fa-star text-warning"></i>
                                                                                {% endfor %}
                                                                            </div>
                                                                        </div>
                                                                        <p class="mb-10"> {{r.review}} <a href="#" class="reply">Reply</a></p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            {% endfor %}
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-4">
                                                        <h4 class="mb-30">Customer reviews</h4>
                                                        <div class="d-flex mb-30">
                                                            <span class="fas fa-star {% if average_rating.rating >= 1 %} checked {% elif average_rating.rating > 0 %} fas fa-star-half-alt half {% endif %}"></span>
                                                            <span class="fas fa-star {% if average_rating.rating >= 2 %} checked {% elif average_rating.rating > 1 %} fas fa-star-half-alt half {% endif %}"></span>
                                                            <span class="fas fa-star {% if average_rating.rating >= 3 %} checked {% elif average_rating.rating > 2 %} fas fa-star-half-alt half {% endif %}"></span>
                                                            <span class="fas fa-star {% if average_rating.rating >= 4 %} checked {% elif average_rating.rating > 3 %} fas fa-star-half-alt half {% endif %}"></span>
                                                            <span class="mr-10 fas fa-star {% if average_rating.rating >= 5 %} checked {% elif average_rating.rating > 4 %} fas fa-star-half-alt half {% endif %}"></span>
                                                            <h6> {% if average_rating.rating %} {{ average_rating.rating|floatformat:1 }} {% else %} 0 {% endif %} out of 5.0</h6>
                                                        </div>
                                                        <div class="progress">
                                                            <span>5 star</span>
                                                            <div class="progress-bar" role="progressbar" style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100">50%</div>
                                                        </div>
                                                        <div class="progress">
                                                            <span>4 star</span>
                                                            <div class="progress-bar" role="progressbar" style="width: 25%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
                                                        </div>
                                                        <div class="progress">
                                                            <span>3 star</span>
                                                            <div class="progress-bar" role="progressbar" style="width: 45%" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100">45%</div>
                                                        </div>
                                                        <div class="progress">
                                                            <span>2 star</span>
                                                            <div class="progress-bar" role="progressbar" style="width: 65%" aria-valuenow="65" aria-valuemin="0" aria-valuemax="100">65%</div>
                                                        </div>
                                                        <div class="progress mb-30">
                                                            <span>1 star</span>
                                                            <div class="progress-bar" role="progressbar" style="width: 85%" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100">85%</div>
                                                        </div>
                                                        <a href="#" class="font-xs text-muted">How are ratings calculated?</a>
                                                    </div>
                                                </div>
                                            </div>
                                            {% if request.user.is_authenticated %}
                                            {% if make_review %}
                                                <div class="comment-form">
                                                    <h4 class="mb-15 add-review">Add a review</h4>
                                                    <strong class="text-success" id="review-res"></strong>
                                                    {% comment %} <div class="product-rate d-inline-block mb-30"></div> {% endcomment %}
                                                    <div class="row">
                                                        <div class="col-lg-8 col-md-12">
                                                            <form class="form-contact comment_form hide-comment_form" action="{% url 'core:ajax-add-review' p.id p.slug p.pid %}" id="commentForm" method="POST">
                                                                {% csrf_token %}
                                                                <div class="row">
                                                                    <div class="col-12">
                                                                        <div class="form-group">
                                                                            {{review_form.review}}
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-12">
                                                                        <div class="form-group">
                                                                            {{review_form.rating}}
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="form-group">
                                                                    <button type="submit" class="button button-contactForm">Submit Review</button>
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            {% endif %}
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-30">
                                {% if products %}
                                <div class="col-12">
                                    <h2 class="section-title style-1 mb-30">Related products</h2>
                                </div>
                                {% else %}
                                <div class="col-12">
                                    <h2 class="section-title style-1 mb-30">No related related products</h2>
                                </div>
                                {% endif %}
                                <div class="col-12">
                                    <div class="row">
                                        <div class="tab-pane fade active show" id="computer" role="tabpanel" aria-labelledby="computer-tab">
                                            <div class="product-bs-slider-2">
                                                <div class="product-slider-3 swiper-container">
                                                    <div class="swiper-wrapper">
                                                        {% for p in products %}
                                                        <div class="product__item swiper-slide">
                                                            <div class="product__thumb fix">
                                                                <div class="product-image w-img">
                                                                    <a href="{{p.get_absolute_url}}">
                                                                        <img src="{{p.image.url}}" alt="product">
                                                                    </a>
                                                                </div>
                                                                <div class="product__offer">
                                                                <span class="discount">{{p.get_percentage|floatformat:0}}%</span>
                                                                </div>
                                                                <div class="product-action">
                                                                    <a aria-label="Add To Wishlist"  class="action-btn add-to-wishlist" data-product-item="{{p.id}}"><i class="fi-rs-heart"></i></a>
                                                                </div>
                                                            </div>
                                                            <div class="product__content pb-0">
                                                                <h6><a href="{{p.get_absolute_url}}">{{p.title|truncatechars:35}}</a></h6>
                                                                <p style="margin-bottom: 0;">By <a href="{{p.vendor.get_absolute_url}}">{{p.vendor.name}}</a></p>
                                                                <div class="rating">
                                                                    <div class="product-rate d-inline-block"> 
                                                                        <div class="product-rating" style="width: 50%"></div>
                                                                    </div>
                                                                    {% comment %} <i class="fas fa-star text-warning"></i>
                                                                    <i class="fas fa-star text-warning"></i>
                                                                    <i class="fas fa-star text-warning"></i> {% endcomment %}
                                                                    <span>({{ p.reviews.all.count }})</span>
                                                                </div>
                                                                <div class="price">
                                                                    <div class="product-price">
                                                                        <strong><span>₵{{p.price}}</span></strong>
                                                                        <del class="old-price font-xs">₵{{p.old_price}}</del>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        {% endfor %}
                                                    </div>
                                                </div>
                                                <!-- If we need navigation buttons -->
                                                <div class="bs-button bs2-button-prev"><i class="fal fa-chevron-left"></i></div>
                                                <div class="bs-button bs2-button-next"><i class="fal fa-chevron-right"></i></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Products from same vendor -->
                            <div class="row">
                            {% if vendor_product %}
                            <div class="col-12">
                                <h2 class="section-title style-1 mb-30">Products from same Vendor</h2>
                            </div>
                                <div class="col-12">
                                    <div class="row">
                                        <div class="tab-pane fade active show" id="computer" role="tabpanel" aria-labelledby="computer-tab">
                                            <div class="product-bs-slider-2">
                                                <div class="product-slider-3 swiper-container">
                                                    <div class="swiper-wrapper">
                                                        {% for p in vendor_product %}
                                                        <div class="product__item swiper-slide">
                                                            <div class="product__thumb fix">
                                                                <div class="product-image w-img">
                                                                    <a href="{{p.get_absolute_url}}">
                                                                        <img src="{{p.image.url}}" alt="product">
                                                                    </a>
                                                                </div>
                                                                <div class="product__offer">
                                                                <span class="discount">{{p.get_percentage|floatformat:0}}%</span>
                                                                </div>
                                                                <div class="product-action">
                                                                        <a aria-label="Add To Wishlist"  class="action-btn add-to-wishlist" data-product-item="{{p.id}}"><i class="fi-rs-heart"></i></a>
                                                                </div>
                                                            </div>
                                                            <div class="product__content pb-0">
                                                                <h6><a href="{{p.get_absolute_url}}">{{p.title|truncatechars:35}}</a></h6>
                                                                <p style="margin-bottom: 0;">By <a href="{{p.vendor.get_absolute_url}}">{{p.vendor.name}}</a></p>
                                                                <div class="rating">
                                                                    <div class="product-rate d-inline-block"> 
                                                                        <div class="product-rating" style="width: 50%"></div>
                                                                    </div>
                                                                    {% comment %} <i class="fas fa-star text-warning"></i>
                                                                    <i class="fas fa-star text-warning"></i>
                                                                    <i class="fas fa-star text-warning"></i> {% endcomment %}
                                                                    <span>({{ p.reviews.all.count }})</span>
                                                                </div>
                                                                <div class="price">
                                                                    <div class="product-price">
                                                                        <strong><span>₵{{p.price}}</span></strong>
                                                                        <del class="old-price font-xs">₵{{p.old_price}}</del>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        {% endfor %}
                                                    </div>
                                                </div>
                                                <!-- If we need navigation buttons -->
                                                <div class="bs-button bs2-button-prev"><i class="fal fa-chevron-left"></i></div>
                                                <div class="bs-button bs2-button-next"><i class="fal fa-chevron-right"></i></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endif %}
                            <!-- //// End product from same vendor -->
                            <!-- Products from same vendor -->
                            <div class="row">
                            {% if recently_viewed_products %}
                            <div class="col-12">
                                <h2 class="section-title style-1 mb-30">Recently Viewed Products</h2>
                            </div>
                                <div class="col-12">
                                    <div class="row">
                                        <div class="tab-pane fade active show" id="computer" role="tabpanel" aria-labelledby="computer-tab">
                                            <div class="product-bs-slider-2">
                                                <div class="product-slider-3 swiper-container">
                                                    <div class="swiper-wrapper">
                                                        {% for p in recently_viewed_products %}
                                                        <div class="product__item swiper-slide">
                                                            <div class="product__thumb fix">
                                                                <div class="product-image w-img">
                                                                    <a href="{{p.get_absolute_url}}">
                                                                        <img src="{{p.image.url}}" alt="product">
                                                                    </a>
                                                                </div>
                                                                <div class="product__offer">
                                                                <span class="discount">{{p.get_percentage|floatformat:0}}%</span>
                                                                </div>
                                                                <div class="product-action">
                                                                        <a aria-label="Add To Wishlist"  class="action-btn add-to-wishlist" data-product-item="{{p.id}}"><i class="fi-rs-heart"></i></a>
                                                                </div>
                                                            </div>
                                                            <div class="product__content pb-0">
                                                                <h6><a href="{{p.get_absolute_url}}">{{p.title|truncatechars:35}}</a></h6>
                                                                <p style="margin-bottom: 0;">By <a href="{{p.vendor.get_absolute_url}}">{{p.vendor.name}}</a></p>
                                                                <div class="rating">
                                                                    <div class="product-rate d-inline-block"> 
                                                                        <div class="product-rating" style="width: 50%"></div>
                                                                    </div>
                                                                    {% comment %} <i class="fas fa-star text-warning"></i>
                                                                    <i class="fas fa-star text-warning"></i>
                                                                    <i class="fas fa-star text-warning"></i> {% endcomment %}
                                                                    <span>({{ p.reviews.all.count }})</span>
                                                                </div>
                                                                <div class="price">
                                                                    <div class="product-price">
                                                                        <strong><span>₵{{p.price}}</span></strong>
                                                                        <del class="old-price font-xs">₵{{p.old_price}}</del>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        {% endfor %}
                                                    </div>
                                                </div>
                                                <!-- If we need navigation buttons -->
                                                <div class="bs-button bs2-button-prev"><i class="fal fa-chevron-left"></i></div>
                                                <div class="bs-button bs2-button-next"><i class="fal fa-chevron-right"></i></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endif %}
                            <!-- //// End product from same vendor -->
                        </div>
                    </div>
                    
                    <div class="col-md-3 col-lg-3 primary-sidebar sticky-sidebar mt-10">
                        <div class="sidebar-widget widget-delivery mb-30 shadow-sm">
                            <h5 class="mb-20"><i class="fas fa-route text-success"></i> Deliver To;</h5>
                            {% if address %}
                            <ul>
                                {% for a in address %}
                                <li>
                                    <span>
                                        <select class="w-100" name="" id="" disabled="disabled">
                                            <option value="">{{a.country}}</option>
                                        </select>
                                        <select class="w-100 my-2" name="" id="" disabled="disabled">
                                            <option value="">{{a.region}}</option>
                                        </select>
                                        <select class="w-100" name="" id="" disabled>
                                            <option value="">{{a.town}}</option>
                                        </select>
                                        <br>
                                    </span>
                                    <a href="{% url 'address:customer_dashboard' %}" class="text-primary font-xs text-muted"><i class="fas fa-edit"></i></a>
                                </li>
                                {% endfor %}
                                <li class="hr"><span></span></li>
                            </ul>
                            {% else %}
                            <ul>
                                <li>
                                    <span>
                                        <select class="w-100" name="" id="" disabled="disabled">
                                            <option value="">COUNTRY - none</option>
                                        </select>
                                        <select class="w-100 my-2" name="" id="" disabled="disabled">
                                            <option value="">REGION -none</option>
                                        </select>
                                        <select class="w-100" name="" id="" disabled>
                                            <option value="">TOWN - none</option>
                                        </select>
                                        <br>
                                    </span>
                                    <a href="{% url 'address:customer_dashboard' %}" class="text-primary font-xs text-muted"><i class="fas fa-edit text-success mx-2"></i>Add Address</a>
                                    <span class="text-danger">Unverified Address</span>                                    
                                </li>
                                <li class="hr"><span></span></li>
                            </ul>
                            {% endif %}
                            <h5 class="section-title style-3 mb-20">Return & Warranty</h5>
                            <ul class="font-xs">
                                <li>
                                    <i class="fi fi-rs-shield-check text-info"></i>
                                    <span class="text-dark text-muted"> {{p.vendor.about.authentic_rating}}% Authentic </span>
                                </li>
                                <li>
                                    <i class="fi fi-rs-time-forward-ten text-info"></i>
                                    <span class="text-dark text-muted">{{p.vendor.about.day_return}} Days Return </span>
                                </li>
                                <li>
                                    <i class="fi fi-rs-diploma text-info"></i>
                                    <span class="text-dark text-muted"> {{p.vendor.about.waranty_period}} Months Warranty </span>
                                </li>
                            </ul>              
                        </div>
                        <div class="sidebar-widget widget-vendor mb-30 shadow-sm">
                            <div class="d-flex justify-content-between">
                                <h5 class="section-title style-3 mb-20">Vendor</h5>
                            <h6>
                                <a href="{{p.vendor.get_absolute_url}}">{{p.vendor.name}}</a>
                            </h6>
                            </div>
                            <div class="vendor-logo d-flex mb-30 justify-content-between">
                                <img src="{{ p.vendor.about.profile_image.url }}" width="100" />
                                <div class="vendor-name">
                                    <div class="product-rate-cover text-end">
                                        <span class="font-small text-muted" >(<span id="followers_all">{{p.vendor.followers.all.count}}</span> Follower{{p.vendor.followers.all.count|pluralize}})</span>
                                    </div>
                                </div>
                            </div>
                            <ul class="contact-infor">
                                <li class="d-flex justify-content-between"><span class="text-dark"><img src="{% static 'assets/imgs/theme/icons/icon-location.svg' %}" alt="" />&nbsp;Location:</span> <span class="text-dark">{{vendor.address}}</span></li>
                                <li class="d-flex justify-content-between"><span class="text-dark"><img src="{% static 'assets/imgs/theme/icons/icon-contact.svg' %}" alt="" />&nbsp;Call:</span> <span class="text-dark">{{vendor.contact}}</span></li>
                                <li class="hr"><span></span></li>
                            </ul>
                            <div class="d-flex justify-content-between">
                                <div>
                                    <p class="text-brand font-xs">Rating</p>
                                    <h4 class="mb-0">{{92}}%</h4>
                                </div>
                                <div>
                                    <p class="text-brand font-xs">Ship on time</p>
                                    <h4 class="mb-0">{{p.vendor.about.shipping_on_time}}%</h4>
                                </div>
                                <div>
                                    <p class="text-brand font-xs">Chat response</p>
                                    <h4 class="mb-0">{{p.vendor.about.chat_resp_time}}%</h4>
                                </div>
                            </div>
                            <div class="my-2 mt-10">
                                <input type="hidden" value="{{request.user.id}}" id="user">
                                <button id="like_button_{{vendor.id}}" onclick="LikeOrUnlike('{{vendor.id}}')" type="button" class="w-100 shadow bg-info rounded-3 py-2 text-white text-uppercase">
                                {% if request.user in vendor.followers.all %}
                                Unfollow
                                {% else %}
                                Follow
                                {% endif %}
                              </button>
                            </div>
                            <div class="my-2 mt-10">
                                <button onclick="openForm()" type="button" class="w-100 shadow bg-info rounded-3 py-2 text-white text-uppercase">
                                <i class="fas fa-comments"></i> Chat 
                              </button>
                            </div>
                            <ul>
                                <li class="hr"><span></span></li>
                            </ul>
                            <p>Become a Vendor? <a href="page-register.html"> Register now</a></p>
                        </div>
                        <!-- Recently added -->
                        {% if recently_added %}
                        <!-- Product sidebar Widget -->
                        <div class="sidebar-widget product-sidebar mb-30 p-30 bg-grey ">
                            <h5 class="section-title style-1 mb-30">New products</h5>
                            {% for r in recently_added %}
                            <div class="single-post clearfix">
                                <div class="image">
                                    <img src="{{r.image.url}}" alt="#" />
                                </div>
                                <div class="content pt-10">
                                    <h5><a href="{{r.get_absolute_url}}">{{r.title|truncatechars:25}}</a></h5>
                                    <p class="price mb-0">₵{{r.price|floatformat:2|intcomma}}</p>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        {% endif %}
                        <!-- End recently_added -->
                        {% if p.video %}
                            <div class="d-lg-block d-none">
                                <div class="mt-30 shadow-sm pt-10 p-30 mb-20">
                                    <h3 class="">Product Video</h3>
                                    <video class="text-center w-100" controls>
                                        <source src="{{p.video.url}}" type="video/mp4">
                                    </video>
                                    </div>
                            </div>
                        {% endif %}
                        <div class="banner-img wow fadeIn mb-lg-0 animated d-lg-block d-none">
                            <img src="{% static 'assets/imgs/banner/banner-11.png' %}" alt="" />
                            <div class="banner-text">
                                <span>Oganic</span>
                                <h4>
                                    Save 17% <br /> on <span class="text-brand">Oganic</span><br /> Juice
                                </h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@500&display=swap');
   
    .card{
        border: none;
        border-radius: 15px;
        display: none;
        position: fixed;
        bottom: 15px;
        right: 15px;
        border: 3px solid #f1f1f1;
        z-index: 9;
        max-height: 600px;
        padding-bottom: 20px;
        margin-bottom: 0px;
    }
    .chat-space{
        height: 600px;
        overflow: scroll;
        
    }
    .adiv{
        background: #16bcdc;
        border-radius: 15px;
        border-bottom-right-radius: 0;
        border-bottom-left-radius: 0;
        color: white;
        padding: 20px;
        position: relative;
        overflow: hidden;
        align-items: center;
    }
   
    .chat{
        border: none;
        background: #E2FFE8;
        border-radius: 20px;
    }
    .msg_container_base{
        background: #e5e5e5;
        margin: 0;
        padding: 0 10px 10px;
        max-height:300px;
        overflow-x:hidden;
    }
    .bg-white{
        border: 1px solid #E7E7E9;
        border-radius: 20px;
    }
    .myvideo img{
        border-radius: 20px
    }
    .dot{
        font-weight: bold;
    }
    .form-control{
        border-radius: 12px;
        border: 1px solid #F0F0F0;
    }
    .form-control:focus{
        box-shadow: none;
        }
    .form-control::placeholder{
        color: #C4C4C4;
    }
    time {
        font-size: 9px;
        color: #0d6efd;
    }
</style>

    <div id="myForm" class="card mt-5 shadow-lg">

      <div class="d-flex flex-row justify-content-between p-2 adiv text-white">
        <i class="fas fa-chevron-left"></i>
        <span class="pb-3">Live chat</span>
        <button onclick="closeForm()" type="button"><i class="fas fa-times"></i></button>
      </div>

      <div class="chat-space mb-20 msg_container_base">
          <div class="d-flex flex-row p-3">
            <img src="https://img.icons8.com/color/48/000000/circled-user-female-skin-type-7.png" width="30" height="30">
            <div class="chat ml-2 p-3">
                <p class="mb-0">Hello and thankyou for visiting birdlymind. Please click the video above</p>
                <time datetime="2009-11-13T20:00">Timothy • 51 min</time>
            </div>
        </div>
          
          <div class="d-flex flex-row p-3" style="justify-content: right;">
            <div class="bg-white mr-2 p-3">
                <p class="mb-0"><span class="text-muted">Hello and thankyou for visiting birdlynind.</span></p>
                <time datetime="2009-11-13T20:00">Timothy • 51 min</time>
            </div>
            <img src="https://img.icons8.com/color/48/000000/circled-user-male-skin-type-7.png" width="30" height="30">
          </div>
  
          <div class="d-flex flex-row p-3">
            <div class="">
                <img src="https://img.icons8.com/color/48/000000/circled-user-female-skin-type-7.png" width="30" height="30">
                <p class="chat ml-2 p-3 mb-0">Hello and thankyou for visiting birdlymind. Please click the video above</p>
                <time style="justify-self: right;" datetime="2009-11-13T20:00">Timothy • 51 min</time>
            </div>
           </div>

          <div class="d-flex flex-row p-3">
            <img src="https://img.icons8.com/color/48/000000/circled-user-female-skin-type-7.png" width="30" height="30">
            <p class="chat ml-2 p-3">Hello and thankyou for visiting birdlymind. Please click the video above</p>
          </div>
          
          <div class="d-flex flex-row p-3" style="justify-content: right;">
            <p class="bg-white mr-2 p-3"><span class="text-muted">Hello and thankyou for visiting birdlynind.</span></p>
            <img src="https://img.icons8.com/color/48/000000/circled-user-male-skin-type-7.png" width="30" height="30">
          </div>
  
          <div class="d-flex flex-row p-3">
              <img src="https://img.icons8.com/color/48/000000/circled-user-female-skin-type-7.png" width="30" height="30">
              <p class="chat ml-2 p-3">Hello and thankyou for visiting birdlymind. Please click the video above</p>
          </div>
  
          <div class="d-flex flex-row p-3" style="justify-content: right;">
            <p class="bg-white mr-2 p-3"><span class="text-muted">Hello and thankyou for visiting birdlynind.</span></p>
            <img src="https://img.icons8.com/color/48/000000/circled-user-male-skin-type-7.png" width="30" height="30">
          </div>
          
          <div class="d-flex flex-row p-3">
            <img src="https://img.icons8.com/color/48/000000/circled-user-female-skin-type-7.png" width="30" height="30">
            <div class="myvideo ml-2"><img src="https://imgur.com/GOxU1jx.png" width="200"></div>
          </div>
          
          <div class="d-flex flex-row p-3">
            <img src="https://img.icons8.com/color/48/000000/circled-user-female-skin-type-7.png" width="30" height="30">
            <p class="chat ml-2 p-3"><span class="text-muted dot">. . .</span></p>
          </div>

        </div>

        <div class="panel-footer mx-4">
            <div class="input-group">
                <input id="btn-input" type="text" class="form-control input-sm chat_input" placeholder="Write your message here..." />
                <span class="input-group-btn">
                <button class="btn btn-primary btn-sm" id="btn-chat">
                    <i class="fas fa-paper-plane"></i>
                </button>
                </span>
            </div>
        </div>

    </div>

<script>
    function openForm() {
        document.getElementById('myForm').style.display = "block";
    }
    function closeForm() {
        document.getElementById('myForm').style.display = "none";
    }
</script>

{% endblock %}


